{{>header}}
    <div class="container-fluid">
      <h1>{{_l.blog.update_blog}}</h1>
      <form class="form form-horizontal" action="{{{_baseUrl}}}{{{_u._blog_save}}}" method="post" role="form">
        <input type="hidden" name="id" value="{{blog.id}}" />
        <input type="hidden" id="blogContentInput" name="content" />
        <input type="hidden" id="blogHtmlInput" name="html" />
        <div class="form-group">
          <label for="title">Title</label>
          <input class="form-control" type="text" id="title" name="title" placeholder="Blog title" value="{{blog.title}}" />
        </div>
        <div class="form-group">
          <label for="blogContent">Content</label>
          <div id="blogContent"></div>
        </div>
        <div class="form-group">
          <label for="active">Active</label>
          <input type="checkbox" id="active" name="active" {{#_is}}{{blog.active}},checked="checked",{{/_is}} />
        </div>
        <div class="form-group">
          <button class="btn btn-success" type="submit">Save</button>
        </div>
      </form>
      <script type="text/javascript">
        $(document).ready(() => {
          let editor = new TuiEditor({
            el: document.querySelector('#blogContent'),
            initialEditType: 'markdown',
            previewStyle: 'vertical',
            height: '400px',
            codeBlockLanguages: ['ruby', 'PHP', 'javascript'],
            initialValue: new TextDecoder().decode(b64.toByteArray('{{{blog.content}}}')),
            events: {
              change: () => {
                $('#blogContentInput').val(editor.getMarkdown())
                $('#blogHtmlInput').val(editor.getHtml())
              }
            }
          })
        })
      </script>
    </div>
{{>footer}}
